<!DOCTYPE html>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58919029-1', 'auto');
  ga('send', 'pageview');

</script>

<html>

<head>
  <meta content="text/html; charset=utf-8" http-equiv="content-type">
  <meta name="robots" content="follow" />
  
  <title>
    MK Dynamics - Computer Security - SLAE64 - SecurityTube Linux Assembly Language and Shellcoding Expert 64-Bit
  </title>
  
  <link href="../../../css/styles.css" type = "text/css" rel = "stylesheet" />
  
  <style>
    .content {
	overflow: auto;
	height: 80%; 
	background: url("../../../images/saturn.jpg") no-repeat center center fixed;
	background-size: cover;
	background-position: center;
	padding: 10px;
	margin: 10px;
	border: 5px solid black;
      }
      
    h1, h2, h3, h4 {
      color: white;
      display: block;     
    }
    
    .current_project_1 {
      border		: 5px solid black;
      background	: gray;
      position		: relative;
      width		: 1370px;
      height		: 200px;
      top		: 0px;
      left		: 0px;
      float		: left;
      margin		: 10px;
      padding-left	: 10px;
    }
    
    .current_project_2 {
      border		: 5px solid black;
      background	: gray;
      position		: relative;
      width		: 1370px;
      height		: 3000px;
      top		: 000px;
      left		: 0px;
      float		: left;
      margin		: 10px;
      padding-left	: 10px;
    }
    
    .current_project_3 {
      border		: 5px solid black;
      background	: gray;
      position		: relative;
      width		: 1370px;
      height		: 1500px;
      top		: 000px;
      left		: 0px;
      float		: left;
      margin		: 10px;
      padding-left	: 10px;
    }
    
    .current_project_4 {
      border		: 5px solid black;
      background	: gray;
      position		: relative;
      width		: 1370px;
      height		: 2500px;
      top		: 000px;
      left		: 0px;
      float		: left;
      margin		: 10px;
      padding		: 10px;
    }
    
    .current_project_5 {
      border		: 5px solid black;
      background	: gray;
      position		: relative;
      width		: 1370px;
      height		: 2500px;
      top		: 000px;
      left		: 0px;
      float		: left;
      margin		: 10px;
      padding		: 10px;
    }
    
    .current_project_6 {
      border		: 5px solid black;
      background	: gray;
      position		: relative;
      width		: 1370px;
      height		: 2500px;
      top		: 000px;
      left		: 0px;
      float		: left;
      margin		: 10px;
      padding		: 10px;
    }
    
    .current_project_7 {
      border		: 5px solid black;
      background	: gray;
      position		: relative;
      width		: 1370px;
      height		: 1500px;
      top		: 000px;
      left		: 0px;
      float		: left;
      margin		: 10px;
      padding		: 10px;
    }
    
    .current_project_8 {
      border		: 5px solid black;
      background	: gray;
      position		: relative;
      width		: 1370px;
      height		: 1500px;
      top		: 000px;
      left		: 0px;
      float		: left;
      margin		: 10px;
      padding		: 10px;
    }
    
    .current_project_9 {
      border		: 5px solid black;
      background	: gray;
      position		: relative;
      width		: 1370px;
      height		: 1500px;
      top		: 000px;
      left		: 0px;
      float		: left;
      margin		: 10px;
      padding		: 10px;
    }
    
    .current_project_10 {
      border		: 5px solid black;
      background	: gray;
      position		: relative;
      width		: 1370px;
      height		: 1500px;
      top		: 000px;
      left		: 0px;
      float		: left;
      margin		: 10px;
      padding		: 10px;
    }
    
    .current_project_11 {
      border		: 5px solid black;
      background	: gray;
      position		: relative;
      width		: 1370px;
      height		: 1500px;
      top		: 000px;
      left		: 0px;
      float		: left;
      margin		: 10px;
      padding		: 10px;
    }
    
    .current_project_12 {
      border		: 5px solid black;
      background	: gray;
      position		: relative;
      width		: 1370px;
      height		: 1500px;
      top		: 000px;
      left		: 0px;
      float		: left;
      margin		: 10px;
      padding		: 10px;
    }
    
    div .img {
      margin		: 0px;
      padding		: 10px;
      height		: auto;
      width		: auto;
      float		: left;
    }
    
    div .img img {
      display		: inline;
      margin		: 0px;
      padding		: 0px;
    }
    
    div .desc {
      color		: white;
      width		: 600px;
      margin		: 5px;
      padding		: 10px;
    }
  </style>
</head>

<body>
    <div class="wrapper">
    
        <header>
    
            <hgroup>
                <h1> 
                    <big> <big> MK Dynamics </big> </big>
                </h1>


                <h2>
                    Computer Security - SLAE64 - Module 1 - Hello World
                </h2>
            </hgroup>
    

            <nav>
                <ul>
                    <li> <a href="../../../index.php">Home</a> </li>
                    <li> <a href="../computer_security_SLAE64.html">Back</a> </li>
                </ul>
            </nav>
    
        </header>
    
        <section class="content">
            
            <!-- ************************************************************************************** First Section Start ************ -->
            <section class="section">
        
                <div class="current_project_1">
                    
                    <hgroup>
                        <h2>
                            Introduction
                        </h2>
                    </hgroup>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            In this section we will be following along with and completing course material from the Pentester Academy's SecurityTube Linux Assembly language Expert 64 Bit course.  The 
                            second assignment is writing a Hello World program in 64 Bit assembly language.  It is to be coded, assembled, linked and run.  Execution is then to be monitored via GDB.  We will use the GEF add-on for GDB to enhance the visual presentation from GDB.
                        </p>
                        <p>
                            Project code is contained in my <a href="https://github.com/markkhusid/SLAE64">github</a>.
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->

                </div> <!-- .current_project_1 -->
        
            </section> <!-- first_section -->
            <!-- *********************************************************************************** Section End ************** -->
            
            <!-- *********************************************************************************** Section Start ************ -->
            <section class="section">
                
                <div class="current_project_2">
                
                    <hgroup>
                        <h2>
                            The program <i>helloworld.asm</i>
                        </h2>
                    </hgroup>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            The screenshot below displays the contents of the program <i>helloworld.asm</i>.  The program contains a string called <i>hello_world</i> that holds the string Hello World to the SLAE-64 Course.  A new line is added by appending the 0x0a ASCII character.  We need to assemble, link, run and instruction step this program in GDB.
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                    
                    <figure>
                        <div class="img">
                            <img 
                            src="../images/SLAE64/Module_1/Hello_world/64bit_hello_world_asm_code.jpg"
                            width="1250"
                            height="900"
                            title=""
                            >
                        </div> <!-- .img -->
                        <div class="desc">
                            <p>
                                The program <i>helloworld.asm</i>
                            <p>
                        </div> <!-- .desc -->
                    </figure>
                    
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            The program is assembled with:
                            <blockquote>
                                $ nasm -felf64 helloworld.asm -o helloworld.o
                            </blockquote>
                            
                            And linked with:
                            <blockquote>
                                $ ld helloworld.o -o helloworld
                            </blockquote>
                        </p>
                        
                        <p>
                            We then run the executable and look at it's objdump.  The results of these operations is shown below:
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                    
                    <figure>
                        <div class="img">
                            <img 
                            src="../images/SLAE64/Module_1/Hello_world/64bit_hello_world_assembling_and_linking.jpg"
                            width="1250"
                            height="900"
                            title=""
                            >
                        </div> <!-- .img -->
                        <div class="desc">
                            <p>
                                Assembling, Linking and Executing the Program <i>helloworld.asm</i>
                            <p>
                        </div> <!-- .desc -->
                    </figure>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            In the above screenshot, we assemble and link the program.  We then use the objdump tool to look at the opcodes within the .text section by using the <i>-d</i> switch.  Finally the program is run using:
                            <blockquote>
                                $ ./helloworld
                            </blockquote>
                        </p>
                        
                        <p>
                            The "./" is needed because the executable is not in a directory listed in the PATH environment variable.
                        </p>
                        
                        <p>
                            In the objdump of the executable, we notice large amounts of null bytes (i.e. 00).  These are not good for shellcode, since in many cases, a victim process encountering a null byte as input understands the null byte as an end of the input.  This would prematurely end the victim program from receiving all of the shellcodes contents.
                        </p>
                        
                        <p>
                            In further videos in this course, the instructor shows how to remove these null bytes, while still maintaining the same functionality in the executable.
                        </p>
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                   
                </div> <!-- .current_project_2 -->
            
            </section> <!-- section -->
            <!-- ************************************************************************************* Section End ************* -->
            
            
            <!-- *********************************************************************************** Section Start ************ -->
            <section class="section">
                
                <div class="current_project_3">
                
                    <hgroup>
                        <h2>
                            Running <i>helloworld</i> in GDB + GEF
                        </h2>
                    </hgroup>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            Setup and before run
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                    
                    <figure>
                        <div class="img">
                            <img 
                            src="../images/SLAE64/Module_1/Hello_world/64bit_hello_world_in_GDB_before_run.jpg"
                            width="1250"
                            height="900"
                            title=""
                            >
                        </div> <!-- .img -->
                        <div class="desc">
                            <p>
                                <i>helloworld</i> in GDB before run
                            <p>
                        </div> <!-- .desc -->
                    </figure>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            From the disassembly of the _start function above, we can notice a difference between our written code and the disassembly of the _start function.  Namely, rather than involving the 64-bit versions of the registers, the assembler optimized away usage of those in favor of the 32-bit versions.  For example, the register RAX was replaced with EAX.
                        </p>
                        
                        <p>
                            From a functionality point of view, this is a moot point.  However, from a shellcoding perspective, it is desireable to have complete control over how the actual opcodes are produced.
                        </p>
                        
                        <p>
                            In the next sections, we will step through the code and describe what occurs.
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                
                </div> <!-- .current_project_3 -->
            
            </section> <!-- section -->
            <!-- ************************************************************************************* Section End ************* -->
        
            <!-- ************************************************************************************* Section Start *********** -->
            <section class="section">
                
                <div class="current_project_4">
                
                    <hgroup>
                        <h2>
                            Running <i>helloworld</i> in GDB + GEF
                        </h2>
                    </hgroup>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            Running step <i><0x401000 <_start>:	mov    eax,0x1</i>
                        </p>
                        
                        <p>
                            Prior to running <i>mov eax, 0x1</i>, the state of the registers and stack is shown below:
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                    
                    <figure>
                        <div class="img">
                            <img 
                            src="../images/SLAE64/Module_1/Hello_world/64bit_hello_world_in_GDB_before_running_step1.jpg"
                            width="1250"
                            height="900"
                            title=""
                            >
                        </div> <!-- .img -->
                        <div class="desc">
                            <p>
                                Prior to executing the instruction <i>mov eax, 0x1</i>
                            <p>
                        </div> <!-- .desc -->
                    </figure>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            The <i>mov eax, 0x1</i> instruction simply moves the immediate value 1 into the 32-bit register eax.
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                    
                    <figure>
                        <div class="img">
                            <img 
                            src="../images/SLAE64/Module_1/Hello_world/64bit_hello_world_in_GDB_after_running_step1.jpg"
                            width="1250"
                            height="900"
                            title=""
                            >
                        </div> <!-- .img -->
                        <div class="desc">
                            <p>
                                After executing the instruction <i>mov eax, 0x1</i>
                            <p>
                        </div> <!-- .desc -->
                    </figure>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            The <i>mov eax, 0x1</i> instruction moved the immediate value 1 into the 64-bit register rax, as can be seen in the screen shot above.
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                
                </div> <!-- .current_project_4 -->
            
            </section> <!-- section -->
            <!-- ************************************************************************************* Section End ************ -->
            
            <!-- ************************************************************************************* Section Start *********** -->
            <section class="section">
                
                <div class="current_project_5">
                
                    <hgroup>
                        <h2>
                            Running <i>helloworld</i> in GDB + GEF
                        </h2>
                    </hgroup>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            Running step <i>0x401005 <_start+5>:	mov    edi,0x1</i>
                        </p>
                        
                        <p>
                            Prior to running the command <i>mov    edi,0x1</i>, the state of the registers and stack are as shown below:
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                    
                    <figure>
                        <div class="img">
                            <img 
                            src="../images/SLAE64/Module_1/Hello_world/64bit_hello_world_in_GDB_before_running_step2.jpg"
                            width="1250"
                            height="900"
                            title=""
                            >
                        </div> <!-- .img -->
                        <div class="desc">
                            <p>
                                Prior to running the command <i>mov    edi,0x1</i>
                            <p>
                        </div> <!-- .desc -->
                    </figure>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            The instruction <i>mov    edi,0x1</i> simply moves the immediate value 1 into the 32-bit register <i>edi</i>.
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                    
                    <figure>
                        <div class="img">
                            <img 
                            src="../images/SLAE64/Module_1/Hello_world/64bit_hello_world_in_GDB_after_running_step2.jpg"
                            width="1250"
                            height="900"
                            title=""
                            >
                        </div> <!-- .img -->
                        <div class="desc">
                            <p>
                                Prior to running the command <i>mov    edi,0x1</i>
                            <p>
                        </div> <!-- .desc -->
                    </figure>
                    
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            The <i>mov eax, 0x1</i> instruction simply moved the immediate value 1 into the 64-bit register rax, as can be seen in the screen shot above.
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                    
                
                </div> <!-- .current_project_5 -->
            
            </section> <!-- section -->
            <!-- ************************************************************************************* Section End ************ -->
            
            <!-- ************************************************************************************* Section Start *********** -->
            <section class="section">
                
                <div class="current_project_6">
                
                    <hgroup>
                        <h2>
                            Running <i>helloworld</i> in GDB + GEF
                        </h2>
                    </hgroup>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            Running the instruction <i>0x40100a <_start+10>:	movabs rsi,0x402000</i>
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                    
                    <figure>
                        <div class="img">
                            <img 
                            src="../images/SLAE64/Module_1/Hello_world/64bit_hello_world_in_GDB_before_running_step3.jpg"
                            width="1250"
                            height="900"
                            title=""
                            >
                        </div> <!-- .img -->
                        <div class="desc">
                            <p>
                                Running step 3
                            <p>
                        </div> <!-- .desc -->
                    </figure>
                    
                    <figure>
                        <div class="img">
                            <img 
                            src="../images/SLAE64/Module_1/Hello_world/64bit_hello_world_in_GDB_after_running_step3.jpg"
                            width="1250"
                            height="900"
                            title=""
                            >
                        </div> <!-- .img -->
                        <div class="desc">
                            <p>
                                Running step 3
                            <p>
                        </div> <!-- .desc -->
                    </figure>
                
                </div> <!-- .current_project_6 -->
            
            </section> <!-- section -->
            <!-- ************************************************************************************* Section End ************ -->
            
            <!-- ************************************************************************************* Section Start *********** -->
            <section class="section">
                
                <div class="current_project_7">
                
                    <hgroup>
                        <h2>
                            Running <i>helloworld</i> in GDB + GEF
                        </h2>
                    </hgroup>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            Running step 4
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                    
                    <figure>
                        <div class="img">
                            <img 
                            src="../images/SLAE64/Module_1/Hello_world/64bit_hello_world_in_GDB_after_run_step4.jpg"
                            width="1250"
                            height="900"
                            title=""
                            >
                        </div> <!-- .img -->
                        <div class="desc">
                            <p>
                                Running step 4
                            <p>
                        </div> <!-- .desc -->
                    </figure>
                
                </div> <!-- .current_project_7 -->
            
            </section> <!-- section -->
            <!-- ************************************************************************************* Section End ************ -->
            
            <!-- ************************************************************************************* Section Start *********** -->
            <section class="section">
                
                <div class="current_project_8">
                
                    <hgroup>
                        <h2>
                            Running <i>helloworld</i> in GDB + GEF
                        </h2>
                    </hgroup>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            Running step 5
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                    
                    <figure>
                        <div class="img">
                            <img 
                            src="../images/SLAE64/Module_1/Hello_world/64bit_hello_world_in_GDB_after_run_step5.jpg"
                            width="1250"
                            height="900"
                            title=""
                            >
                        </div> <!-- .img -->
                        <div class="desc">
                            <p>
                                Running step 5
                            <p>
                        </div> <!-- .desc -->
                    </figure>
                
                </div> <!-- .current_project_8 -->
            
            </section> <!-- third_section -->
            <!-- ************************************************************************************* Section End ************ -->
            
            <!-- ************************************************************************************* Section Start *********** -->
            <section class="section">
                
                <div class="current_project_9">
                
                    <hgroup>
                        <h2>
                            Running <i>helloworld</i> in GDB + GEF
                        </h2>
                    </hgroup>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            Running step 6
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                    
                    <figure>
                        <div class="img">
                            <img 
                            src="../images/SLAE64/Module_1/Hello_world/64bit_hello_world_in_GDB_after_run_step6.jpg"
                            width="1250"
                            height="900"
                            title=""
                            >
                        </div> <!-- .img -->
                        <div class="desc">
                            <p>
                                Running step 6
                            <p>
                        </div> <!-- .desc -->
                    </figure>
                
                </div> <!-- .current_project_9 -->
            
            </section> <!-- third_section -->
            <!-- ************************************************************************************* Section End ************ -->
            
            <!-- ************************************************************************************* Section Start *********** -->
            <section class="section">
                
                <div class="current_project_10">
                
                    <hgroup>
                        <h2>
                            Running <i>helloworld</i> in GDB + GEF
                        </h2>
                    </hgroup>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            Running step 7
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                    
                    <figure>
                        <div class="img">
                            <img 
                            src="../images/SLAE64/Module_1/Hello_world/64bit_hello_world_in_GDB_after_run_step7.jpg"
                            width="1250"
                            height="900"
                            title=""
                            >
                        </div> <!-- .img -->
                        <div class="desc">
                            <p>
                                Running step 7
                            <p>
                        </div> <!-- .desc -->
                    </figure>
                
                </div> <!-- .current_project_10 -->
            
            </section> <!-- third_section -->
            <!-- ************************************************************************************* Section End ************ -->
            
            <!-- ************************************************************************************* Section Start *********** -->
            <section class="section">
                
                <div class="current_project_11">
                
                    <hgroup>
                        <h2>
                            Running <i>helloworld</i> in GDB + GEF
                        </h2>
                    </hgroup>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            Running step 8
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                    
                    <figure>
                        <div class="img">
                            <img 
                            src="../images/SLAE64/Module_1/Hello_world/64bit_hello_world_in_GDB_after_run_step8.jpg"
                            width="1250"
                            height="900"
                            title=""
                            >
                        </div> <!-- .img -->
                        <div class="desc">
                            <p>
                                Running step 8
                            <p>
                        </div> <!-- .desc -->
                    </figure>
                
                </div> <!-- .current_project_11 -->
            
            </section> <!-- third_section -->
            <!-- ************************************************************************************* Section End ************ -->
            
            <!-- ************************************************************************************* Section Start *********** -->
            <section class="section">
                
                <div class="current_project_12">
                
                    <hgroup>
                        <h2>
                            Running <i>helloworld</i> in GDB + GEF
                        </h2>
                    </hgroup>
                    
                    <!-- ********************************************************************* Loose Text -->                
                    <div class="loose_text">
                        
                        <p>
                            Examining Memory
                        </p>
                        
                    </div> <!-- .loose_text -->
                    <!-- ********************************************************************* Loose Text -->
                    
                    <figure>
                        <div class="img">
                            <img 
                            src="../images/SLAE64/Module_1/Hello_world/64bit_hello_world_in_GDB_examine_memory.jpg"
                            width="1250"
                            height="900"
                            title=""
                            >
                        </div> <!-- .img -->
                        <div class="desc">
                            <p>
                                Examining Memory
                            <p>
                        </div> <!-- .desc -->
                    </figure>
                
                </div> <!-- .current_project_11 -->
            
            </section> <!-- third_section -->
            <!-- ************************************************************************************* Section End ************ -->
            
        </section>	<!-- .content -->
    
    <div> <!-- .wrapper -->

  </body>

</html>
