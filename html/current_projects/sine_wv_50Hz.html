<!DOCTYPE html>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58919029-1', 'auto');
  ga('send', 'pageview');

</script>

<html>

<head>
  <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">

  <title>
    MK Dynamics
  </title>
  
  <link href="../css/styles.css" type = "text/css" rel = "stylesheet" />
  
  
    
    <style>
        p {
            font-family: Arial;
            color: black;
        }
    </style>
  
</head>

<body>

  <h1> 
    <big> <big> MK Dynamics </big> </big>
  </h1>

  <h2>
    Current Projects - Discretized Fourier Transform of Sine Wave at 50Hz using FFTW3
  </h2>
  
  <div id="nav">
    <ul>
      <li> <a href="../index.php">Home</a> </li>
      <li> <a href="../current_projects/current_projects_FFTW3.html">Back</a></li>
    </ul>
  </div>
  
  <hr />
  
  <p>
    <img src="../images/spacey.jpg" alt ="Space" class = "align-center medium" />
  
  <div id="content">
    <h3>
      Formation of a 50Hz Sine Wave using Python+Numpy on Jupyter Notebook
    </h3>
    
    <h4>
      Discussion:
      <hr />
    </h4>
    <p>
        We use Python together Numpy arrays and Matplotlib within a Jupyter Notebook to create a sine wave at 50Hz for 10 periods.  We then plot the time domain graph of the sine wave, and then compute the Discretized Fast Fourier Transform using the Python libraries.  The time domain data is then outputted to a file and used as an input for the DFFT Fortran program to computed the DFFT and plot its output with GNUPlot.
      <hr /><br>
    </p>
    
    <p> <b> Introduction: </b><br>
      First, we start with a Python script written in Jupyter Notebook to generate a 50Hz sine wave, sampled at 44100Hz, for 10 periods, and save these raw data points to a file.  The Jupyter Notebook is shown below.  
    </p>
    
    <p> <b> Python code to generate a 50Hz sine wave sampled at 44100Hz.</b> <br>
      <iframe
	src = "code_FFTW3/sine50Hz_jupyter_python.html"
	width = "850"
	height = "600"
	frameborder = "1"
	scrolling = "yes">
      </iframe> <br>
      Download the code by clicking the link below:<br>
      <a href="code_FFTW3/sine50Hz_text.py" target="_top">Python script file to generate 50Hz sine wave</a><br><br>
    </p>
    
    <p>
      We then run the code and obtain a time domain plot and a frequency domain plot.  The results are plotted with GNUPlot:<br>
    </p>
    
    <p><b> Image of 50Hz Sine Wave Generated Using Python+Numpy on Jupyter Notebook and Plotted with GNUPlot</b><br>
        <img 
            src="images/FFTW3/sine_wv_50Hz.png" 
            width="600" 
            height="450" 
            title="50Hz Sine Wave"
        />
        <br>
        Download the image by clicking the link below:<br>
        <a href="images/FFTW3/sine_wv_50Hz.png" target="_top">Image of 50Hz sine wave</a><br><br><br>
    
        <img 
            src="images/FFTW3/sine_wv_50Hz_freq_domain.png" 
            width="600" 
            height="450" 
            title="50Hz Sine Wave"
        />
        <br>
        Download the image by clicking the link below:<br>
        <a href="images/FFTW3/sine_wv_50Hz_freq_domain.png" target="_top">Image of FFT of 50Hz sine wave</a><br>
    
    </p>

    <p> <b> Obtaining Discretized Fast Fourier Transform of Raw Data File </b> <br>
      Now that the Python+Numpy on Jupyter Notebook script has output time domain data elements into a file, these<br>
      data elements can now be fed into the FFTW3 DFFT algorithm.  The algorithm is used within a Fortran 2003 program.<br>
      <a href="current_projects_FFTW3.html#Fortran 2003 Code">Click this link to see the Fortran 2003 DFFT code.</a><br>
    </p>
    
    <p> <b> Running the Fortran 2003 DFFT Program and Obtaining Output Files </b> <br>
      <a href="current_projects_FFTW3.html#Fortran 2003 Code">The Fortran 2003 code</a> is compiled and run with the raw data text file as input.  The resulting files <br>
      include the DFFT magnitude and phase. <br>
    </p>
    
    <p>
      Compile by typing: <b>gfortran -o a.out data_file_FFTW_ver6.F03 -lfftw3</b> <br>
      Run by typing: <b>./a.out outfile.dat DFFT_mag_file.dat DFFT_phase_file.dat sample_rate num_periods</b> <br>
      where outfile.dat is the output of the Python script, DFFT_mag_file.dat is the DFFT magnitude file,<br>
      DFFT_phase_file.dat is the DFFT phase file,sample_rate is the rate of sampling of the input data file, and num_periods<br>
      is the number of periods of data in the input data file.<br>
      The line count can be obtained by typing: <b>wc -l outfile.dat</b> 
    </p>
    
    <p> <b> The Output Files From the Fortran 2003 DFFT Program </b> <br>
      After the Fortran 2003 DFFT program has been run correctly, magnitude and phase files should <br>
      appear.  
      The program output is verbose (for debug) purposes and the screen output is shown below: <br>
      <iframe
	src = "code_FFTW3/fft_of_dat_screen_output.txt"
	width = "550"
	height = "200"
	frameborder = "1"
	scrolling = "yes">
      </iframe><br>
      The full text may be downloaded <a href="code_FFTW3/fft_of_dat_screen_output.txt">here.</a><br>
    </p>
    
    <p>
    
    <p> <b>Plots of the magnitude output file using GNUPlot</b><br>
      The magnitude output file is plotted with GNUPlot.  A GNUPlot script file was created <br>
      to facilitate quality plotting. <br>
      <b>GNUPlot script file</b><br>
      <iframe
	src = "code_FFTW3/sine_wv_50Hz_DFFT_gnuplot_macro.txt"
	width = "550"
	height = "120"
	frameborder = "1"
	scrolling = "no">
      </iframe><br>
      The GNUPlot script file may be downloaded by clicking <a href="code_FFTW3/sine_wv_50Hz_gnuplot_macro.txt">here.</a><br>
      Run by typing <b>gnuplot sine_wv_50Hz_DFFT_gnuplot_macro.txt</b> or start GNUPlot and enter<br>
      <b>load "sine_wv_50Hz_DFFT_gnuplot_macro.txt"</b> at the gnuplot command prompt <br>
      
      <br><b> Magnitude Plot </b><br>
      <img src="images/FFTW3/DFFT_sine_wv_50Hz.png" width="600" height="450" title="Magnitude plot of DFFT of 50Hz sine wave"/><br>
      
    
    <h4>
      Discussion:
      <hr />
    </h4>
    <p>
      There appears to be a slight decrease in the peak of the magnitude of the DFFT plot.  It appears to show a peak of around 8 units, rather than purely 10 units.  Since other raw data inputs into the Fortran program produced results as expected, the skew may be related to the way the data were generated in Python+Numpy or the way it was saved into a text file.  There also appears to be some secondary peaks that rapidly roll off on both sides of the main peak.  This is most likely due to the FFTW3 algorithm responding to the discontinuities of the input data. More research is needed to find the causes.
      <hr />      
    </p>
   
   <a href="current_projects_FFTW3.html#DFFT Program Performance">Back to Current Projects - FFTW3</a>
    
</body>
</html>
    
